
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Simulator S &#8212; Computing in Physics (Phy446)</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'QC/SimulatorS';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Simulator M-(abcd)" href="1b-QuantumComputingSimulator.html" />
    <link rel="prev" title="QC Simulators" href="1a-QuantumComputingSimulator.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../Overview.html">
  
  
  
  
  
  
    <p class="title logo__title">Computing in Physics (Phy446)</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Setting up</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../GettingStarted.html">Getting Setup</a></li>






</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Cellular Automata</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../CellularAutomata/CellularAutomata.html">Cellular Automata</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CellularAutomata/Sand.html">Sand</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CellularAutomata/OtherAutomata.html">Other Interesting Automata</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quantum Computing</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="0-DiracNotation.html">Dirac Notation</a></li>

<li class="toctree-l1 current active has-children"><a class="reference internal" href="1a-QuantumComputingSimulator.html">QC Simulators</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Simulator S</a></li>
<li class="toctree-l2"><a class="reference internal" href="1b-QuantumComputingSimulator.html">Simulator M-(abcd)</a></li>
<li class="toctree-l2"><a class="reference internal" href="Measuring.html">Measuring and Input</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="NonAtomicGates.html">Non-atomic gates</a></li>

<li class="toctree-l1"><a class="reference internal" href="PhaseEstimation.html">Phase estimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="QFT.html">Quantum Fourier Transform</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="Shor-Overview.html">Shor’s Algorithm</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="Shor-Classical.html">Shor’s Algorithm (classically)</a></li>
<li class="toctree-l2"><a class="reference internal" href="Shor-Quantum.html">Quantum Matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="ModularMultiplication.html">Modular Multiplication</a></li>
<li class="toctree-l2"><a class="reference internal" href="Shor-QuantumCircuit.html">Shor’s Algorithm</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quantum Computing (extensions)</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="Gates.html">Gates</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="ClassicalGates.html">Classical Gates</a></li>
<li class="toctree-l2"><a class="reference internal" href="ControlledGates.html">Controlled Gates</a></li>
<li class="toctree-l2"><a class="reference internal" href="Universal.html">Gates for any Unitary</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="BQPinPSPACE.html">BQP in PSPACE</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Ising Model</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Ising/Overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ising/IsingModel.html">Simulating an Ising Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ising/Measure.html">Measuring the Ising Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ising/RG.html">The Renormalization Group</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Ising/SimulatedAnnealing.html">Extra Credit: Simulated Annealing</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Ising/ProteinFolding.html">Protein Folding</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../Ising/ParallelTempering.html">Extra Credit: Parallel Tempering</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Machine Learning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../ML/Overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ML/Hopfield.html">Hopfield Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ML/RBM.html">Restricted Boltzmann Machines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ML/Diffusion.html">Generative Diffusion Models</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Topological Insulators</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../TI/Overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../TI/Lattice.html">Lattices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../TI/TightBinding.html">Tight Binding Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../TI/ChernInsulators.html">Topological Insulators</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">



<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Simulator S</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hadamard">Hadamard</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#phase-gate">Phase Gate</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cnot">CNOT</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#duplicate-states">Duplicate States</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#putting-it-together">Putting it Together</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#video">Video</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="simulator-s">
<h1>Simulator S<a class="headerlink" href="#simulator-s" title="Link to this heading">#</a></h1>
<p>In this simulator, we will primarily represent the state in Dirac notation as a list of tuples of (amplitude,BitString) as we did in the Dirac Notation section.</p>
<p>For example, you could assume that the current state looks like</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myState</span><span class="o">=</span><span class="p">[</span>
  <span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.1</span><span class="p">),</span> <span class="s1">&#39;00&#39;</span><span class="p">),</span>
  <span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.4</span><span class="p">),</span> <span class="s1">&#39;01&#39;</span><span class="p">)</span> <span class="p">,</span>
  <span class="p">(</span><span class="o">-</span><span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span> <span class="s1">&#39;11&#39;</span> <span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
<p>To build simulator S, we then need to learn how each gate changes the state of the quantum system.</p>
<section id="hadamard">
<h2>Hadamard<a class="headerlink" href="#hadamard" title="Link to this heading">#</a></h2>
<p>Let’s start with the Hadamard gate on a single wire.</p>
<p><img alt="" src="../_images/H1.png" /></p>
<p>One way to understand this gate is to understand what it does to <span class="math notranslate nohighlight">\(|0\rangle\)</span> and <span class="math notranslate nohighlight">\(|1\rangle\)</span>.</p>
<p>In particular a <strong>Hadamard</strong> takes</p>
<div class="math notranslate nohighlight">
\[
|0\rangle \rightarrow \frac{1}{\sqrt{2}}(|0\rangle + |1\rangle)
\]</div>
<div class="math notranslate nohighlight">
\[
|1\rangle \rightarrow \frac{1}{\sqrt{2}}(|0\rangle - |1\rangle)
\]</div>
<p>It turns out because quantum mechanics is linear, this is all that we need to know because then</p>
<div class="math notranslate nohighlight">
\[
\alpha|0\rangle + \beta|1\rangle \rightarrow \frac{\alpha}{\sqrt{2}}(|0\rangle + |1\rangle) +  \frac{\beta}{\sqrt{2}}(|0\rangle - |1\rangle)
\]</div>
<div class="math notranslate nohighlight">
\[
= \frac{\alpha + \beta}{\sqrt{2}} |0\rangle + \frac{\alpha - \beta}{\sqrt{2}} |1\rangle
\]</div>
<p>Now, suppose that instead of being on a single wire, a gate is on the middle of three wires.
<img alt="" src="../_images/H3.png" /></p>
<p>Sneakily what’s happening is that the gate acts on all three wires; it just does nothing on the wires that we don’t write it on (the gate is applying the identity operator).</p>
<p>We should describe what happens on all the binary numbers <span class="math notranslate nohighlight">\(|000\rangle, |001\rangle, ... |010\rangle ... |111\rangle\)</span>. We can think about the Hadamard applied to <span class="math notranslate nohighlight">\(|010\rangle\)</span> as <span class="math notranslate nohighlight">\(|0\rangle H|1\rangle |0\rangle\)</span> which is</p>
<div class="math notranslate nohighlight">
\[ 
|0\rangle \frac{1}{\sqrt{2}}(|0\rangle - |1\rangle) |0\rangle
\]</div>
<div class="math notranslate nohighlight">
\[
=\frac{1}{\sqrt{2}}|000\rangle - |010\rangle 
\]</div>
<p>We now need to write a function</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">H</span><span class="p">(</span><span class="n">wire</span><span class="p">,</span><span class="n">inputState</span><span class="p">):</span>
  <span class="c1"># do stuff</span>
  <span class="c1"># return newState</span>
</pre></div>
</div>
<p>To accomplish this, just go ahead and loop through you old state and apply the gate to every element of your old state:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">inputState</span><span class="p">:</span>
   <span class="n">newState</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>  <span class="c1"># apply the gate to one basis element and get some new basis element(s)</span>
   <span class="n">newState</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>In some sense, it is the trickiest of the gates you are working with.  If the wire the Hadamard gate is being applied to is 0, you need to push back two new tuples:</p>
<ul class="simple">
<li><p>the first one is the same binary number with an amplitudes which is scaled by <span class="math notranslate nohighlight">\(1/\sqrt{2}\)</span></p></li>
<li><p>the second one is the binary number which replaces the 0 with a 1 on that wire and is scaled by <span class="math notranslate nohighlight">\(1/\sqrt{2}\)</span></p></li>
</ul>
<p>If the wire the Hadamard is being applied to is a 1, you need to push back two new tuples:</p>
<ul class="simple">
<li><p>the first one is the same binary number with an amplitudes which is scaled by <span class="math notranslate nohighlight">\(1/\sqrt{2}\)</span></p></li>
<li><p>the second one is the binary number which replaces the 0 with a 1 on that wire and is scaled by <span class="math notranslate nohighlight">\(-1/\sqrt{2}\)</span></p></li>
</ul>
<div class="tip admonition">
<p class="admonition-title">Faster and More Elegant Python</p>
<p>Although we’ve described the process as using a for-loop you could actually do better by using a list comprehension like</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myState</span><span class="o">=</span><span class="p">[</span><span class="n">H</span><span class="p">(</span><span class="n">wire1</span><span class="p">,</span><span class="n">state</span><span class="p">)</span> <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">inputState</span><span class="p">]</span>
</pre></div>
</div>
<p>where the function <code class="docutils literal notranslate"><span class="pre">H</span></code> takes only a single state - i.e. (amplitude,binary_number) - and returns a list of the new (amplitude,binary_numbers) which come from the application of the Hadamard.</p>
<p>If you do it this way, <code class="docutils literal notranslate"><span class="pre">myState</span></code> will be a list of lists which you will need to turn back into a single list.  You can do this using</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myState</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">myState</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>You may end up with duplicate states when you do this - i.e. two states such as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myState</span><span class="o">=</span><span class="p">[</span>
  <span class="p">(</span><span class="o">-</span><span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.125</span><span class="p">),</span> <span class="s1">&#39;11&#39;</span> <span class="p">)</span>
  <span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.1</span><span class="p">),</span> <span class="s1">&#39;00&#39;</span><span class="p">),</span>
  <span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.4</span><span class="p">),</span> <span class="s1">&#39;01&#39;</span><span class="p">)</span> <span class="p">,</span>
  <span class="p">(</span><span class="o">-</span><span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.125</span><span class="p">),</span> <span class="s1">&#39;11&#39;</span> <span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Don’t worry about this at the moment.  You’re going to fix this problem in a couple minutes.  It’s worth noticing that the Hadamard will, generically, double the number of terms.</p>
<p>Go ahead and check your function by sending it a state (and a wire) and see if you get the right answer.</p>
</section>
<section id="phase-gate">
<h2>Phase Gate<a class="headerlink" href="#phase-gate" title="Link to this heading">#</a></h2>
<p>The <strong>Phase(<span class="math notranslate nohighlight">\(\theta\)</span>)</strong> gate works similary to the Hadamard.  It’s a single gate which applies to one wire</p>
<p><img alt="" src="../_images/p1.png" /></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
|0\rangle \rightarrow |0\rangle \\\\
|1\rangle \rightarrow e^{i\theta}|1\rangle
\end{eqnarray}
\end{split}\]</div>
<p>It is actually pretty simple to deal with in Simulator S.  For each binary number, you just need to check if the phase gate has a 1 on the relevant wire. If it does, you need to change the amplitude by <span class="math notranslate nohighlight">\(\exp[i \theta]\)</span>.  Notice that no matter what wire the gate is applied to, you end up with the change to the overall amplitude.</p>
<p>Write a function</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">Phase</span><span class="p">(</span><span class="n">wire</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span><span class="n">inputState</span><span class="p">):</span>
  <span class="c1"># do stuff</span>
  <span class="c1"># return newState</span>
</pre></div>
</div>
<p>which applies the phase gate to state.  Again, like you did with the Hadamard state, go ahead and test that the code works.</p>
</section>
<section id="cnot">
<h2>CNOT<a class="headerlink" href="#cnot" title="Link to this heading">#</a></h2>
<p>The <strong>CNOT</strong> gate differs in that it spans two wires</p>
<p><img alt="" src="../_images/CNOT1.png" /></p>
<p>and has an orientation associated with it. The pictured CNOT is “right-size up” and the “control-wire” is blue.</p>
<p>Because it spans two wires, we need to describe how it acts on four basis elements.</p>
<p>Conceptually the controlled-not is a gate which not’s the second wire when the control wire is one.
Here we’ve described the equations when the control wire is atop the not-wire.  It is left as an exercise for the reader to describe how this changes when the control wire is lower then the not-wire but your code should work for both.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
|00\rangle \rightarrow |00\rangle \\
|01\rangle \rightarrow |01\rangle \\
|10\rangle \rightarrow |11\rangle \\
|11\rangle \rightarrow |10\rangle
\end{eqnarray}
\end{split}\]</div>
<p>Write code to implement</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">CNOT</span><span class="p">(</span><span class="n">controlWire</span><span class="p">,</span><span class="n">notWire</span><span class="p">,</span><span class="n">inputState</span><span class="p">):</span>
  <span class="c1"># do stuff</span>
  <span class="c1"># return newState</span>
</pre></div>
</div>
<p>For the CNOT gate, this is very easy:</p>
<ul class="simple">
<li><p>for every basis element, look at its current binary number.</p></li>
<li><p>check if the binary number is 1 on the control-wire. If it is, flip the not-wire</p></li>
<li><p>append back to newState a tuple with the same amplitude but a different binary number.</p></li>
</ul>
</section>
<section id="duplicate-states">
<h2>Duplicate States<a class="headerlink" href="#duplicate-states" title="Link to this heading">#</a></h2>
<p>Now we will deal with the fact that you will occassionally get duplicate states.  This actually can only  happen after the application of the Hadamard.</p>
<p>Write some code which takes the state and adds duplicates (i.e. <code class="docutils literal notranslate"><span class="pre">myState=AddDuplicates(myState)</span></code> should give</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myState</span><span class="o">=</span><span class="p">[</span>
  <span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.1</span><span class="p">),</span> <span class="s1">&#39;00&#39;</span><span class="p">),</span>
  <span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.4</span><span class="p">),</span> <span class="s1">&#39;01&#39;</span><span class="p">)</span> <span class="p">,</span>
  <span class="p">(</span><span class="o">-</span><span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span> <span class="s1">&#39;11&#39;</span> <span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
<p>when applied to</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myState</span><span class="o">=</span><span class="p">[</span>
  <span class="p">(</span><span class="o">-</span><span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.125</span><span class="p">),</span> <span class="s1">&#39;11&#39;</span> <span class="p">)</span>
  <span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.1</span><span class="p">),</span> <span class="s1">&#39;00&#39;</span><span class="p">),</span>
  <span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.4</span><span class="p">),</span> <span class="s1">&#39;01&#39;</span><span class="p">)</span> <span class="p">,</span>
  <span class="p">(</span><span class="o">-</span><span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.125</span><span class="p">),</span> <span class="s1">&#39;11&#39;</span> <span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Make sure you also remove any term which has an amplitude zero.</p>
</section>
<section id="putting-it-together">
<h2>Putting it Together<a class="headerlink" href="#putting-it-together" title="Link to this heading">#</a></h2>
<p>Once you have implemented these functions, you now need to put it all together.  The next step is to configure your program to read the input from a file and then run each of the gates in hand (apply gate to current state; get new state; repeat). Parsing input is a bit annoying, so we’re happy to give you this piece. Go ahead and use the following if you want.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">ReadInputString</span><span class="p">(</span><span class="n">myInput_lines</span><span class="p">):</span>
    <span class="n">myInput</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">myInput_lines</span><span class="o">=</span><span class="n">myInput_lines</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">myInput_lines</span> <span class="o">=</span> <span class="p">[</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">myInput_lines</span> <span class="k">if</span> <span class="n">i</span><span class="o">!=</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="n">numberOfWires</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">myInput_lines</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">myInput_lines</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
        <span class="n">myInput</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">numberOfWires</span><span class="p">,</span><span class="n">myInput</span><span class="p">)</span>
</pre></div>
</div>
<p>Then you can read the gate by doing things like</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">numberOfWires</span><span class="p">,</span><span class="n">myInput</span><span class="o">=</span><span class="n">ReadInputString</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">3</span>
<span class="s1">H 1</span>
<span class="s1">H 2</span>
<span class="s1">P 2 0.3</span>
<span class="s1">CNOT 2 1</span>
<span class="s1">H 1</span>
<span class="s1">H 2</span>
<span class="s1">CNOT 2 0</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>or alternatively from a file like <code class="docutils literal notranslate"><span class="pre">test.circuit</span></code> by</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">numberOfWires</span><span class="p">,</span><span class="n">myInput</span><span class="o">=</span><span class="n">ReadInputString</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;test.circuit&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>
</div>
<p>At this point you should be able to take a circuit description and print out the quantum state of the system at the end.  You should be using your pretty print functions to print this out in a nice way using Dirac notation.</p>
<div class="tip admonition">
<p class="admonition-title">Example input file</p>
<p>For testing you can use the input above (whose answer is given on the Simulator page).  Also, you can find an example input file for testing here: <a class="reference download internal" download="" href="../_downloads/7815f3bac18b03bffcce93ca48f53856/example.circuit"><code class="xref download docutils literal notranslate"><span class="pre">images/example.circuit</span></code></a>.</p>
<p>Your output (in Dirac notation) should be</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[((</span><span class="mf">0.4999999999999999</span><span class="o">+</span><span class="mi">0</span><span class="n">j</span><span class="p">),</span> <span class="s1">&#39;0000&#39;</span><span class="p">),</span> <span class="p">((</span><span class="mf">0.4999999999999999</span><span class="o">+</span><span class="mi">0</span><span class="n">j</span><span class="p">),</span> <span class="s1">&#39;0011&#39;</span><span class="p">),</span> <span class="p">((</span><span class="mf">0.4502235511763384</span><span class="o">+</span><span class="mf">0.21748276705561506</span><span class="n">j</span><span class="p">),</span> <span class="s1">&#39;1100&#39;</span><span class="p">),</span> <span class="p">((</span><span class="mf">0.4502235511763384</span><span class="o">+</span><span class="mf">0.21748276705561506</span><span class="n">j</span><span class="p">),</span> <span class="s1">&#39;1111&#39;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
<p>Congrats! At this point you should have a basic working simulator.</p>
<div class="caution admonition">
<p class="admonition-title">Grading</p>
<p>Hopefully at this point you’ve tested your simulator and are convinced that it works.  To grade your simulator, run it on <code class="docutils literal notranslate"><span class="pre">rand.circuit</span></code> below.  You should paste your results to this output into your document.</p>
<!-- One of our inputs has a `MEASURE` at the end.  For this input you should produce a graph which is a histogram of output versus counts.
 -->
<p><strong>Tests:</strong></p>
<ul class="simple">
<li><p><a class="reference external" href="https://clark.physics.illinois.edu/rand.circuit">rand.circuit</a></p></li>
</ul>
<!--
* {download}`measure.circuit`
* {download}`input.circuit`
* {download}`myInputState.txt`
-->
</div>
</section>
<section id="video">
<h2>Video<a class="headerlink" href="#video" title="Link to this heading">#</a></h2>
<iframe id="kmsembed-1_aw4mcv37" width="640" height="394" src="https://mediaspace.illinois.edu/embed/secure/iframe/entryId/1_aw4mcv37/uiConfId/26883701/st/0" class="kmsembed" allowfullscreen webkitallowfullscreen mozAllowFullScreen allow="autoplay *; fullscreen *; encrypted-media *" referrerPolicy="no-referrer-when-downgrade" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Phys 446: Simulator S"></iframe></section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./QC"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="1a-QuantumComputingSimulator.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">QC Simulators</p>
      </div>
    </a>
    <a class="right-next"
       href="1b-QuantumComputingSimulator.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Simulator M-(abcd)</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hadamard">Hadamard</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#phase-gate">Phase Gate</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cnot">CNOT</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#duplicate-states">Duplicate States</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#putting-it-together">Putting it Together</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#video">Video</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Bryan Clark
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>